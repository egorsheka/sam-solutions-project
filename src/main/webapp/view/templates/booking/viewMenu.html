<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4">>
<head>
    <meta charset="UTF-8">
    <title>menu</title>

    <script type="text/javascript" th:src="@{/script/jquery.js}"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
          integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" th:href="@{/css/newMenu.css}">
    <link rel="stylesheet" type="text/css" th:href="@{/css/style.css}">
    <link rel="stylesheet" type="text/css" th:href="@{/css/viewMenu.css}">
    <script src="https://kit.fontawesome.com/a076d05399.js"></script>


    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
          integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
            integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
            crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
            integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
            crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
            integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
            crossorigin="anonymous"></script>


</head>
<body class="back">

<div sec:authorize="hasAuthority('COOK')">
    <div th:replace="fragments/cookNavbar :: cookNavbar"></div>
</div>
<div sec:authorize="hasAuthority('CLIENT')">
    <div th:replace="fragments/clientNavbar :: clientNavbar"></div>
</div>
<div sec:authorize="!isAuthenticated()">
    <nav class="navbar navbar-dark bg-dark" style="position: fixed; top: -3px; width: 100%;z-index: 2">
        <a class="navbar-brand"></a>

        <div class="form-inline  app-nav-bar-container" style="width: 70px">
            <a class="nav-link active app-nav-link-item"
               th:href="${(#mvc.url('USIC#login')).build()}" th:text="#{text.login}"
               style="flex:1; width: 30px; margin-left: -30px;">Login</a>

        </div>
    </nav>
</div>

<form action="#" th:action="@{/viewMenu}" th:object="${order}" method="post">
    <div>
        <div class="main-div-img" style="height: 213px;   width: 100%;"></div>
        <div style="background-color: #6b2024; height: 70px; width: 100%;">

            <div style="color:white; font-size: 30px; text-align: center;
            display: flex;
            align-items: center;
            justify-content: center ">

                <span>in</span>
                <div style="padding: 10px;">
                    <select class="form-control input-main" th:field="${order.town}" id="select_">
                        <option th:each="t : ${townList}" th:value="${t.id}" th:text="${t.name}"></option>
                    </select>
                </div>

                <div style="padding: 10px;">
                    <select class="form-control input-main" th:field="${order.district.id}" id="selectDistricts"
                            style="z-index: 2">
                        <option th:each="district : ${districtList}" th:value="${district.id}"
                                th:text="${district.name}">
                        </option>
                    </select>
                    <label id="labelId" style="display: none"  th:text="${order.district.id}"></label>
                </div>

                <div>
                    <span>on</span>
                </div>


                <div style="padding: 10px;">
                    <input class="form-control input-main" id="orderedDate" type="date" th:value="${order.date}"
                           th:field="${order.date}"
                           min="2019-12-01" max="2020-06-31">

                </div>

                <span>at</span>
                <div style="padding: 10px;">
                    <select th:field="${order.time}" class="form-control" style="width: 90px">
                        <option th:value="${'01:00'}" th:text="${'01:00'}">01:00</option>
                        <option th:value="${'02:00'}" th:text="${'02:00'}">02:00</option>
                        <option th:value="${'03:00'}" th:text="${'03:00'}">03:00</option>
                        <option th:value="${'04:00'}" th:text="${'04:00'}">04:00</option>
                        <option th:value="${'05:00'}" th:text="${'05:00'}">05:00</option>
                        <option th:value="${'06:00'}" th:text="${'06:00'}">06:00</option>
                        <option th:value="${'07:00'}" th:text="${'07:00'}">07:00</option>
                        <option th:value="${'08:00'}" th:text="${'08:00'}">08:00</option>
                        <option th:value="${'09:00'}" th:text="${'09:00'}">09:00</option>
                        <option th:value="${'10:00'}" th:text="${'10:00'}">10:00</option>
                        <option th:value="${'11:00'}" th:text="${'11:00'}">11:00</option>
                        <option th:value="${'12:00'}" th:text="${'12:00'}">12:00</option>
                        <option th:value="${'13:00'}" th:text="${'13:00'}">13:00</option>
                        <option th:value="${'14:00'}" th:text="${'14:00'}">14:00</option>
                        <option th:value="${'15:00'}" th:text="${'15:00'}">15:00</option>
                        <option th:value="${'16:00'}" th:text="${'16:00'}">16:00</option>
                        <option th:value="${'17:00'}" th:text="${'17:00'}">17:00</option>
                        <option th:value="${'18:00'}" th:text="${'18:00'}">18:00</option>
                        <option th:value="${'19:00'}" th:text="${'19:00'}" selected>19:00</option>
                        <option th:value="${'20:00'}" th:text="${'20:00'}">20:00</option>
                        <option th:value="${'21:00'}" th:text="${'21:00'}">21:00</option>
                        <option th:value="${'22:00'}" th:text="${'22:00'}">22:00</option>
                        <option th:value="${'23:00'}" th:text="${'23:00'}">23:00</option>
                        <option th:value="${'24:00'}" th:text="${'24:00'}">23:00</option>
                    </select>
                </div>


                <div style="padding: 10px;">
                    <button th:text="#{text.view_menu}" name="save" type="submit" class="btn btn-warning"
                            style=" border-radius: 5px; margin-top: 10px">view menu
                    </button>
                </div>


            </div>


        </div>
        <div class="row justify-content-center"
             style="webkit-repeating-linear-gradient(-45deg,#f9f8f6,#f9f8f6 3px,#eae9e8 4px,#f9f8f6 5px);
    background-image: -moz-repeating-linear-gradient(-45deg,#f9f8f6,#f9f8f6 3px,#eae9e8 4px,#f9f8f6 5px);
    background-image: -o-repeating-linear-gradient(-45deg,#f9f8f6,#f9f8f6 3px,#eae9e8 4px,#f9f8f6 5px);
    background-image: repeating-linear-gradient(-45deg,#f9f8f6,#f9f8f6 3px,#eae9e8 4px,#f9f8f6 5px); width: 100%; height: 130px;bottom: 482px; margin-right: 0px;margin-left: 0px;">
            <div style="width: 600px; margin-top: 20px">
                <div class="card cuisine-card d-inline-block" style="height: 25px; margin-top: 3px; margin-right: 3px"
                     th:each="cuisine : ${allCuisines}"
                     th:value="${cuisine.name}"
                     th:id="${cuisine.id + cuisine.name}" onclick="getCuisine(this)">
                    <label class="cuisine-card-label" style="font-size: 15px" th:text="${cuisine.name}"></label>
                </div>
            </div>
        </div>
    </div>

    <div style="visibility: hidden" id="container">
    </div>
</form>


<div th:if="${menuList.empty == true}" class="row justify-content-center" style="margin: auto; width: 100%">
    <label class="first-label"  th:text="#{text.No_menus_for_this_request}" style="font-size: 70px;">No menus for this request</label>
</div>

<div class="row justify-content-center" style="margin-right: 15px; margin-left: 15px">

    <div class=" d-inline-block">
        <div class="card main-div" th:each="menuItem, item : ${menuList}" th:if="${item.index % 2  == 0}"
             style="height: 250px; margin-top: 23px">
            <div th:id="${'carouselExampleIndicators' + item.index}" class="carousel slide" data-ride="carousel">
                <ol class="carousel-indicators">
                    <li data-target="#carouselExampleIndicators" th:each="dish, itemDish : ${menuItem.dishes}"
                        th:data-slide-to="${itemDish.index}"></li>

                </ol>
                <div class="carousel-inner">
                    <div class="carousel-item active" th:each="dish, itemDish : ${menuItem.dishes}"
                         th:if="${itemDish.index == 0}">
                        <img class="d-block w-100" th:src="@{/images/dish2.jpg}" alt="First slide"
                             style="max-height: 210px; min-height: 210px;">
                        <div class="carousel-caption d-none d-md-block">
                            <h5 th:text="${menuItem.name}"></h5>
                        </div>
                    </div>
                    <div class="carousel-item" th:each="dish, itemDish : ${menuItem.dishes}"
                         th:if="${itemDish.index != 0}">
                        <img class="d-block w-100" th:src="@{/images/dish3.jpg}" alt="First slide"
                             style="max-height: 210px; min-height: 210px;">
                        <div class="carousel-caption d-none d-md-block">
                            <h5 th:text="${menuItem.name}"></h5>
                        </div>
                    </div>
                </div>

                <a class="carousel-control-prev" th:href="${'#carouselExampleIndicators' + item.index}"
                   role="button"
                   data-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="sr-only">Previous</span>
                </a>
                <a class="carousel-control-next" th:href="${'#carouselExampleIndicators' + item.index}"
                   role="button"
                   data-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="sr-only">Next</span>
                </a>
            </div>

            <div class="card-body">

                <div style="position: absolute; top: 217px">
                    <label th:text="${menuItem.price}"></label>
                    <label th:text="#{text.Price_per_guest}">Price per guest </label>
                </div>

                <form action="#" th:action="@{/selectTheMenu}" th:object="${orderDto}" method="post">
                    <input type="hidden" th:value="${menuItem.id}" th:name="menuId">
                    <input type="hidden" th:field="${order.district.id}" th:value="${order.district.id}">
                    <input type="hidden" th:name="date" th:value="${order.date}">
                    <input type="hidden" th:name="time" th:value="${order.time}">
                    <div style="position: absolute; top: 215px; right: 30px">
                        <button class="btn btn-classic save" type="submit" th:id="${'saveButton' + item.index}"
                                style=" font-size: 13px;  width : 150px; height: 25px;">
                            <span th:for="${'saveButton' + item.index}" style="position: relative; top: -5px;" th:text="#{text.SELECT_THIS_MENU}">SELECT THIS MENU</span>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div class=" d-inline-block">
        <div class="card main-div" th:each="menuItem, item : ${menuList}" th:if="${item.index % 2  == 1}"
             style="height: 250px; margin-top: 23px">
            <div th:id="${'carouselExampleIndicators' + item.index}" class="carousel slide" data-ride="carousel">
                <ol class="carousel-indicators">
                    <li data-target="#carouselExampleIndicators" th:each="dish, itemDish : ${menuItem.dishes}"
                        th:data-slide-to="${itemDish.index}"></li>

                </ol>
                <div class="carousel-inner">
                    <div class="carousel-item active" th:each="dish, itemDish : ${menuItem.dishes}"
                         th:if="${itemDish.index == 0}">
                        <img class="d-block w-100" th:src="@{/images/dish.jpg}" alt="First slide"
                             style="max-height: 210px; min-height: 210px;">
                        <div class="carousel-caption d-none d-md-block">
                            <h5 th:text="${menuItem.name}"></h5>
                        </div>
                    </div>
                    <div class="carousel-item" th:each="dish, itemDish : ${menuItem.dishes}"
                         th:if="${itemDish.index != 0}">
                        <img class="d-block w-100" th:src="@{/images/dish.jpg}" alt="First slide"
                             style="max-height: 210px; min-height: 210px;">
                        <div class="carousel-caption d-none d-md-block">
                            <h5 th:text="${menuItem.name}"></h5>

                        </div>
                    </div>
                </div>

                <a class="carousel-control-prev" th:href="${'#carouselExampleIndicators' + item.index}"
                   role="button"
                   data-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="sr-only">Previous</span>
                </a>
                <a class="carousel-control-next" th:href="${'#carouselExampleIndicators' + item.index}"
                   role="button"
                   data-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="sr-only">Next</span>
                </a>
            </div>

            <div class="card-body">

                <div style="position: absolute; top: 217px">
                    <label th:text="${menuItem.price}"></label>
                    <label th:text="#{text.Price_per_guest}">Price per guest </label>
                </div>
                <form action="#" th:action="@{/selectTheMenu}" th:object="${orderDto}" method="post">
                    <input type="hidden" th:value="${menuItem.id}" th:name="menuId">
                    <input type="hidden" th:field="${order.district.id}" th:value="${order.district.id}">
                    <input type="hidden" th:name="date" th:value="${order.date}">
                    <input type="hidden" th:name="time" th:value="${order.time}">
                    <div style="position: absolute; top: 215px; right: 30px">
                        <button class="btn btn-classic save" type="submit" th:id="${'saveButton' + item.index}"
                                style=" font-size: 13px;  width : 150px; height: 25px;">
                            <span th:for="${'saveButton' + item.index}" style="position: relative; top: -5px;" th:text="#{text.SELECT_THIS_MENU}" >SELECT THIS MENU</span>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>


</div>


<script type="text/javascript" th:src="@{/script/jquery.js}"></script>

<script type="text/javascript" th:src="@{/script/mainPage.js}"></script>


<script type="text/javascript">
    var count = 0;
    function getCuisine(param) {
        console.log(param.name);
        console.log(param.id);
        if(param.id.toString().indexOf('-') !== -1){
            count--;
            console.log('id = ')
            console.log(param.id)
            document.getElementById('in' + param.id).remove();

            const c = document.getElementById(param.id);
            c.setAttribute("style", "height: 25px; margin-top: 3px; margin-right: 3px; background-color: white; color: #999");
            c.setAttribute("id", param.id.toString().substr(0, param.id.toString().length - 1))

        }else{
            if(count < 5) {

                let regex = param.id.match(/(\d+)(.+)(-?)/);
                let parentId = regex[1];
                let parentName = regex[2];

                const mainDish = document.getElementById(param.id);
                mainDish.setAttribute("style", "height: 25px; margin-top: 3px; margin-right: 3px; background-color: rgb(243, 153, 57); color: white");
                mainDish.setAttribute("id", param.id + '-');


                let div = document.getElementById('container');
                let newElement = document.createElement('div');
                newElement.setAttribute("style", "visibility: hidden");
                newElement.innerHTML = '<input type="hidden" id="'+ 'in' + param.id+'"  name=\"cuisineList[' + count + '].name\" value=\"' + parentName + '\">';
                div.append(newElement);
                count++;
            }
        }

    }



</script>

</body>


</html>



